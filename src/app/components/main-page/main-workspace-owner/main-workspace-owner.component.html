<div class="content-header-container">
  <app-main-content-header
    fxFlex="grow"
    [content]="content"
    [isSearchOn]="true"
    [labels]="[]"
    [isAutocompleteDisabled]="true">
  </app-main-content-header>
</div>

<div class="workspace-owner-content-wrapper" fxLayout="row" fxLayoutAlign="space-between stretch">
  <!-- Left Column : Workspace list -->
  <div class="workspace-list-container mt-10 mr-15 ml-15" fxFlex="0 0 300px"
       fxLayout="column" fxLayoutGap="10px">
    <!-- Workspace Buttons -->
    <div class="workspaces-actions-container" fxLayout="column" fxLayoutAlign="start stretch" fxLayoutGap="5px">
      <ng-container *ngIf="isDemoButtonShown; else workspaceCreationBlock">
        <button mat-flat-button class="create-demo-workspace-button inversion primary"
                aria-label="create demo workspace" (click)="createDemoWorkspace()">
          <mat-icon>add</mat-icon>
          <span>Create demo workspace</span>
        </button>
      </ng-container>
      <ng-template #workspaceCreationBlock>
        <button mat-flat-button
                class="create-workspace-button"
                [ngClass]="{'inversion primary': isQuotaLeft()}"
                aria-label="create a new workspace"
                [disabled]="!isQuotaLeft()"
                (click)="openWorkspaceCreationDialog()">
          <mat-icon class="mr-5">add</mat-icon>
          <span>Create workspace</span>
        </button>
      </ng-template>
    </div>

    <!-- Workspace List -->
    <div class="workspace-list" *ngIf="workspaces">
      <ng-container *ngFor="let workspace of workspaces">
        <mat-card class="workspace-widget mb-5"
                  [ngClass]="{'selected': isWorkspaceSelected(workspace)}"
                  (click)="navigateToWorkspaceItem(workspace.id)">
          <!-- widget header -->
          <div class="card-header" fxLayout="row" fxLayoutAlign="space-between stretch">
            <div class="card-media v-centering__horizontal" fxFlex="0 0 45px">
              <mat-icon>people_outline</mat-icon>
            </div>
            <div class="workspace-name v-centering" fxFlex="grow"
                 matBadge="new" matBadgePosition="above after" matBadgeColor="accent"
                 [matBadgeHidden]="!isNewWorkspace(workspace.id)">
              {{ workspace.name }}
            </div>
            <div class="workspace-selected-arrow v-centering__horizontal" fxFlex="0 0 25px"
                 *ngIf="workspace.id === selectedWorkspaceId">
              <mat-icon>navigate_next</mat-icon>
            </div>
          </div>
          <!-- widget detail -->
          <mat-card-content class="card-info" fxLayout="column"
                            *ngIf="isWorkspaceSelected(workspace)">
            <div class="description pb-10">
              {{ workspace.description || 'No description for the workspace' }}
            </div>
            <div class="join-code-info pt-10 pb-10" fxLayout="row" fxLayoutAlign="space-between stretch">
              <span class="function-title" fxFlex="0 0 75px">Join code</span>
              <div class="open-join-code-button" fxLayout="row"
                   (click)="openJoinCodeDialog(workspace)">
                <mat-icon class="mr-5">vpn_key</mat-icon>
                <div class="chip__hidden v-centering__inline">● ● ● ● ● ● ●</div>
              </div>
            </div>
            <div class="expiration-date-info pt-10" fxLayout="row" fxLayoutAlign="space-between stretch">
              <span class="function-title" fxFlex="0 0 75px">Expiring by</span>
              <span class="expiration-date">{{ getExpiry_date(workspace) }}</span>
            </div>
          </mat-card-content>
        </mat-card>
      </ng-container>
    </div>
  </div>
  <!--  //// END div.workspaces-actions-container -->

  <!-- Right Column : Workspace Detail -->
  <div class="workspace-detail-container" fxFlex="grow">
    <ng-container *ngIf="selectedWorkspaceId; else elseBlock">
      <nav mat-tab-nav-bar mat-align-tabs="center" animationDuration="0ms">
        <a mat-tab-link
           [routerLink]="[selectedWorkspaceId+'/info']"
           routerLinkActive #info="routerLinkActive"
           [active]="info.isActive">
          <mat-icon fontSet="material-icons-outlined">settings</mat-icon>
          {{ selectedWorkspace.name }}
        </a>
        <a mat-tab-link
           [routerLink]="[selectedWorkspaceId+'/environments']"
           routerLinkActive #environments="routerLinkActive"
           [active]="environments.isActive">
          <!-- <mat-icon class="mr-5" fontSet="material-icons-outlined">import_contacts</mat-icon>-->
          Environments
          <div *ngIf="environmentCount >= 0" class="chip__m ml-5 v-centering__inline">{{environmentCount}}</div>
        </a>
        <a mat-tab-link
           [routerLink]="[selectedWorkspaceId+'/members']"
           routerLinkActive #members="routerLinkActive"
           [active]="members.isActive">
          <!-- <mat-icon fontSet="material-icons-outlined">person</mat-icon>-->
          Members
          <div *ngIf="memberCount >= 0" class="chip__m v-centering__inline ml-5">{{memberCount}}</div>
        </a>
      </nav>
    </ng-container>
    <ng-template #elseBlock>
      <div class="error-message">
        <h3>{{ notFoundMessage }}</h3>
        <p> Please select another workspace from the left column. </p>
      </div>
    </ng-template>
    <div class="workspace-detail-tab-content">
      <router-outlet></router-outlet>
    </div>
  </div>
  <!--  //// END div.workspace-detail-container -->
</div>
