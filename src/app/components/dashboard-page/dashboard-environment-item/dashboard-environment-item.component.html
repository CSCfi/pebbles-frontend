<ng-container *ngIf="environment">
  <mat-card class="environment-card r__all" data-environment-item-id="environment.id"
  fxLayout="row" fxLayoutAlign="space-between stretch">

    <div class="card-media v-centering__horizontal" fxFlex="0 0 120px">
      <div class="thumbnail" [innerHTML]="getThumbnail()"></div>
    </div>

    <div class="card-details" fxFlex="grow">
      <mat-card-header>
        <mat-card-title> {{ environment.name }} </mat-card-title>
        <mat-card-subtitle *ngIf="environment.workspace_name !== 'System.default'">
          <span class="heading">@</span> {{ environment.workspace_name }}
        </mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <p [innerHTML]="environment.description"></p>
        <div class="label-list">
          <mat-chip-list aria-label="labels">
            <ng-container *ngFor="let label of environment.labels">
              <mat-chip>{{ label }}</mat-chip>
            </ng-container>
          </mat-chip-list>
        </div>
      </mat-card-content>
    </div>

    <mat-card-actions class="mat-card-actions inversion light-gray" [ngClass]="{ 'active':getInstance() }"
    fxFlex="0 0 150px"
    fxLayout="column" fxLayoutAlign="start stretch"
    *ngIf="content.path === 'catalog'">

      <div class="progress-spinner-container v-centering" fxFlex="0 0 135px">
        <mat-progress-spinner class="environment-spiner-background"
        diameter="110" strokeWidth="8"
        [mode]="spinnerMode" [value]="lifetimePercentage">
        </mat-progress-spinner>

        <div class="lifetime-info">
          <ng-container *ngIf="getInstance(); else inactive">
            <p>{{ lifetimePercentage }} %</p>
            <p>{{ getInstance().lifetime_left }} / {{ environment.maximumLifetime }}</p>
          </ng-container>
          <ng-template #inactive>
            <p class="heading"> Lifetime </p>
            <p class="time">{{ environment.maximumLifetime }}</p>
          </ng-template>
        </div>
      </div>
      <div class="instance-action-ui"  fxFlex="grow"
      fxLayout="column">
        <!-- Action view 1 : Active Environments -->
        <ng-container *ngIf="actionsVisible(); else LaunchUI">
          <button mat-flat-button class="open-button v-centering__inline"
          (click)="openEnvironmentInBrowser()">
            Open
            <mat-icon>launch</mat-icon>
          </button>
          <button mat-flat-button class="stop_button v-centering__inline"
          (click)="stopEnvironment()">
            Shutdown
            <mat-icon>close</mat-icon>
          </button>
        </ng-container>
        <!-- Action view 2 : Deactivated environments -->
        <ng-template #LaunchUI>
          <button mat-flat-button class="launch-button"
          (click)="startEnvironment()">
            <!-- <mat-icon fontSet="material-icons-outlined">power_settings_new</mat-icon> -->
            Start
            <!-- <mat-icon>play_arrow</mat-icon> -->
          </button>
        </ng-template>
      </div>
    </mat-card-actions>

    <mat-card-actions *ngIf="content.path.includes('workspace-owner/detail')">
      <button mat-flat-button (click)="openDialog()">
        <mat-icon>edit</mat-icon><span> Edit  </span>
      </button>
    </mat-card-actions>

  </mat-card>
</ng-container>
